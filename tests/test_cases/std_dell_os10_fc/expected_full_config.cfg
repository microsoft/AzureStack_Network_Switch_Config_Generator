! system.j2 - hostname
! Name: s46-r06-5248hl-6-1a
! Make: dellemc
! Model: s5248f-on
hostname s46-r06-5248hl-6-1a

banner motd #
NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE

hostname s46-r06-5248hl-6-1a
Unauthorized access and/or use prohibited.
All access and/or use subject to monitoring.

NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE   NOTICE
#


! system.j2 - features
lldp enable
dcbx enable


! system.j2 - ntp
clock timezone standard-timezone America/Los_Angeles
ntp server [NTP_SERVER_IP]
ntp source [MGMT_VLAN]


! system.j2 - syslog
logging server [LOG_SERVER_IP]
logging source-interface [MGMT_VLAN]
logging source-interface vlan125
logging audit enable
logging console disable


! system.j2 - global_settings
ztd cancel
mac address-table aging-time 1000000

no ip dhcp-relay information-option
no ip dhcp snooping


vrrp version 3
vrrp delay reload 180


! system.j2 - snmp_settings
snmp-server community [SNMP_COMMUNITY_RO] ro
snmp-server community [SNMP_COMMUNITY_RW] rw
snmp-server contact "Contact Support"
snmp-server location 


! system.j2 - management_vrf
ip vrf management
 interface management

management route 0.0.0.0/0 [MGMT_GATEWAY_IP]

! login.j2

password-attributes character-restriction upper 1 lower 1 numeric 1 special-char 1 min-length 15 lockout-period 15 max-retry 3
password-attributes lockout-period 5


enable password 0 $CREDENTIAL_PLACEHOLDER$ priv-lvl 15
username admin password $CREDENTIAL_PLACEHOLDER$ role sysadmin
username $CREDENTIAL_PLACEHOLDER$ password $CREDENTIAL_PLACEHOLDER$ role sysadmin


ip ssh server enable
ip ssh server cipher aes256-ctr aes192-ctr aes128-ctr
ip ssh server mac hmac-sha1 hmac-sha2-256
ip ssh server max-auth-tries 3
no ip telnet server enable


login concurrent-session limit 3
login statistics enable


! Replace [TACACS_SERVER1], [TACACS_SERVER2], [TACACS_KEY], and [MGMT_VLAN] with actual values.
ip tacacs source-interface [MGMT_VLAN]
tacacs-server host [TACACS_SERVER1] key [TACACS_KEY]
tacacs-server host [TACACS_SERVER2] key [TACACS_KEY]

aaa authentication login default group tacacs+
aaa authentication login console group tacacs+ local
aaa accounting commands all default start-stop group tacacs+

! qos.j2

wred ecn
  random-detect color green minimum-threshold 150 maximum-threshold 1500 drop-probability 100
  random-detect ecn


class-map type network-qos AZLOCAL_COS3
  match qos-group 3

class-map type network-qos AZLOCAL_COS7
  match qos-group 7


class-map type queuing AZLOCAL_QUEUE0
  match queue 0

class-map type queuing AZLOCAL_QUEUE3
  match queue 3

class-map type queuing AZLOCAL_QUEUE7
  match queue 7


trust dot1p-map AZLOCAL_DOT1P_TRUST
  qos-group 0 dot1p 0-2,4-6
  qos-group 3 dot1p 3
  qos-group 7 dot1p 7


qos-map traffic-class AZLOCAL_QOS_MAP
  queue 0 qos-group 0-2,4-6
  queue 3 qos-group 3
  queue 7 qos-group 7


policy-map type network-qos AZLOCAL_PFC
  class AZLOCAL_COS3
    pause
    pfc-cos 3


policy-map type queuing AZLOCAL_ETS
  class AZLOCAL_QUEUE0
    bandwidth percent 48

  class AZLOCAL_QUEUE3
    bandwidth percent 50
    random-detect ecn

  class AZLOCAL_QUEUE7
    bandwidth percent 2


system qos
  trust-map dot1p AZLOCAL_DOT1P_TRUST
  ets mode on

! vlan.j2
interface vlan2
  description UNUSED_VLAN
  shutdown
interface vlan6
  description HNVPA_6
  mtu 9216
  no shutdown
  ip address 100.71.143.2/25
  vrrp-group 6
    priority 150
    virtual-address 100.71.143.1
    no preempt
interface vlan7
  description Infra_7
  mtu 9216
  no shutdown
  ip address 100.68.148.2/24
  vrrp-group 7
    priority 150
    virtual-address 100.68.148.1
    no preempt
interface vlan99
  description NativeVlan
  no shutdown
interface vlan125
  description BMC_Mgmt_125
  mtu 9216
  no shutdown
  ip address 100.71.12.123/26
  vrrp-group 125
    priority 150
    virtual-address 100.71.12.65
    no preempt
interface vlan201
  description Tenant_201
  mtu 9216
  no shutdown
  ip address 100.68.149.2/24
  vrrp-group 201
    priority 150
    virtual-address 100.68.149.1
    no preempt
interface vlan301
  description LogicalTenant_301
  mtu 9216
  no shutdown
  ip address 100.68.150.2/25
  vrrp-group 301
    priority 150
    virtual-address 100.68.150.1
    no preempt
interface vlan401
  description DhcpTenant_401
  mtu 9216
  no shutdown
  ip address 100.68.150.130/25
  vrrp-group 401
    priority 150
    virtual-address 100.68.150.129
    no preempt
interface vlan501
  description L3forward_501
  mtu 9216
  no shutdown
  ip address 100.68.151.2/28
  vrrp-group 501
    priority 150
    virtual-address 100.68.151.1
    no preempt
interface vlan502
  description L3forward_502
  mtu 9216
  no shutdown
  ip address 100.68.151.18/28
  vrrp-group 502
    priority 150
    virtual-address 100.68.151.17
    no preempt
interface vlan503
  description L3forward_503
  mtu 9216
  no shutdown
  ip address 100.68.151.34/28
  vrrp-group 503
    priority 150
    virtual-address 100.68.151.33
    no preempt
interface vlan504
  description L3forward_504
  mtu 9216
  no shutdown
  ip address 100.68.151.50/28
  vrrp-group 504
    priority 150
    virtual-address 100.68.151.49
    no preempt
interface vlan505
  description L3forward_505
  mtu 9216
  no shutdown
  ip address 100.68.151.66/28
  vrrp-group 505
    priority 150
    virtual-address 100.68.151.65
    no preempt
interface vlan506
  description L3forward_506
  mtu 9216
  no shutdown
  ip address 100.68.151.82/28
  vrrp-group 506
    priority 150
    virtual-address 100.68.151.81
    no preempt
interface vlan507
  description L3forward_507
  mtu 9216
  no shutdown
  ip address 100.68.151.98/28
  vrrp-group 507
    priority 150
    virtual-address 100.68.151.97
    no preempt
interface vlan508
  description L3forward_508
  mtu 9216
  no shutdown
  ip address 100.68.151.114/28
  vrrp-group 508
    priority 150
    virtual-address 100.68.151.113
    no preempt
interface vlan509
  description L3forward_509
  mtu 9216
  no shutdown
  ip address 100.68.151.130/28
  vrrp-group 509
    priority 150
    virtual-address 100.68.151.129
    no preempt
interface vlan510
  description L3forward_510
  mtu 9216
  no shutdown
  ip address 100.68.151.145/28
  vrrp-group 510
    priority 150
    virtual-address 10.69.179.145
    no preempt
interface vlan511
  description L3forward_511
  mtu 9216
  no shutdown
  ip address 100.68.151.162/28
  vrrp-group 511
    priority 150
    virtual-address 100.68.151.161
    no preempt
interface vlan512
  description L3forward_512
  mtu 9216
  no shutdown
  ip address 100.68.151.178/28
  vrrp-group 512
    priority 150
    virtual-address 100.68.151.177
    no preempt
interface vlan513
  description L3forward_513
  mtu 9216
  no shutdown
  ip address 100.68.151.194/28
  vrrp-group 513
    priority 150
    virtual-address 100.68.151.193
    no preempt
interface vlan514
  description L3forward_514
  mtu 9216
  no shutdown
  ip address 100.68.151.210/28
  vrrp-group 514
    priority 150
    virtual-address 100.68.151.209
    no preempt
interface vlan515
  description L3forward_515
  mtu 9216
  no shutdown
  ip address 100.68.151.226/28
  vrrp-group 515
    priority 150
    virtual-address 100.68.151.225
    no preempt
interface vlan516
  description L3forward_516
  mtu 9216
  no shutdown
  ip address 100.68.151.242/28
  vrrp-group 516
    priority 150
    virtual-address 100.68.151.241
    no preempt
interface vlan711
  description Storage_711_TOR1
  no shutdown
interface vlan712
  description Storage_711_TOR2
  no shutdown

! interface.j2 - dell

! NOTE: This interface configuration initializes ports in shutdown state for security.
! This is a recommended best practice to prevent unauthorized access on unused ports.
! User may choose to apply this initial configuration or customize based on deployment requirements.
interface range Ethernet 1/1/1-1/1/56
  description Unused
  switchport mode access
  switchport access vlan 2
  spanning-tree bpduguard enable
  spanning-tree guard root
  spanning-tree port type edge
  mtu 9216
  shutdown


interface Ethernet 1/1/44
  description Trunk_TO_BMC_SWITCH
  switchport mode trunk
  switchport access vlan 99
  switchport trunk allowed vlan 125
  mtu 9216
  no shutdown

interface range Ethernet 1/1/1-1/1/18
  description HyperConverged_To_Host
  switchport mode trunk
  switchport access vlan 7
  switchport trunk allowed vlan 7,6,201,301,401,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,711
  mtu 9216
  service-policy input type network-qos AZLOCAL-QOS-MAP
  no shutdown



interface Ethernet 1/1/48
  description P2P_Border1
  no switchport
  ip address 100.71.12.2/30
  mtu 9216
  no shutdown

interface Ethernet 1/1/47
  description P2P_Border2
  no switchport
  ip address 100.71.12.10/30
  mtu 9216
  no shutdown


interface loopbackloopback0
  description Loopback0
  ip address 100.71.12.21/32
  mtu 9216
  no shutdown



! port-channel.j2
  
interface port-channel50
  description P2P_IBGP
  no shutdown
  no switchport
  mtu 9216
  ip address 100.71.12.17/30

  
interface Ethernet 1/1/39
  description P2P_IBGP
  no shutdown
  channel-group 50 mode active
  no switchport
  mtu 9216
  flowcontrol receive off
  
interface Ethernet 1/1/40
  description P2P_IBGP
  no shutdown
  channel-group 50 mode active
  no switchport
  mtu 9216
  flowcontrol receive off
  
  
interface port-channel101
  description ToR_Peer_Link
  no shutdown
  switchport mode trunk
  switchport access vlan 99
  switchport trunk allowed vlan 
  vlt-port-channel 101
  priority-flow-control mode on
  mtu 9216

  
interface Ethernet 1/1/49
  description ToR_Peer_Link
  no shutdown
  channel-group 101 mode active
    
    switchport
    switchport mode trunk
    switchport trunk native vlan 99
    switchport trunk allowed vlan 
    spanning-tree port type network
    mtu 9216
    flowcontrol receive off
  
interface Ethernet 1/1/50
  description ToR_Peer_Link
  no shutdown
  channel-group 101 mode active
    
    switchport
    switchport mode trunk
    switchport trunk native vlan 99
    switchport trunk allowed vlan 
    spanning-tree port type network
    mtu 9216
    flowcontrol receive off
  
interface Ethernet 1/1/51
  description ToR_Peer_Link
  no shutdown
  channel-group 101 mode active
    
    switchport
    switchport mode trunk
    switchport trunk native vlan 99
    switchport trunk allowed vlan 
    spanning-tree port type network
    mtu 9216
    flowcontrol receive off
  
interface Ethernet 1/1/52
  description ToR_Peer_Link
  no shutdown
  channel-group 101 mode active
    
    switchport
    switchport mode trunk
    switchport trunk native vlan 99
    switchport trunk allowed vlan 
    spanning-tree port type network
    mtu 9216
    flowcontrol receive off
  

! vlt.j2 - NOTICE: VLT configuration skipped - MLAG peer link interface not found

! prefix_list.j2
  
ip prefix-list DefaultRoute seq 10 permit 0.0.0.0/0
ip prefix-list DefaultRoute seq 50 deny 0.0.0.0/0 le 32

! bgp.j2

router bgp 64556
  router-id 100.71.12.21
  bestpath as-path multipath-relax
  log-neighbor-changes
  maximum-paths ibgp 8
  maximum-paths ebgp 8
  address-family ipv4 unicast
    network 100.71.12.2/30
    network 100.71.12.10/30
    network 100.71.12.21/32
    network 100.68.149.0/24
    network 100.68.150.0/25
    network 100.68.150.128/25
    network 100.68.151.0/28
    network 100.68.151.16/28
    network 100.68.151.32/28
    network 100.68.151.48/28
    network 100.68.151.64/28
    network 100.68.151.80/28
    network 100.68.151.96/28
    network 100.68.151.112/28
    network 100.68.151.128/28
    network 100.68.151.144/28
    network 100.68.151.160/28
    network 100.68.151.176/28
    network 100.68.151.192/28
    network 100.68.151.208/28
    network 100.68.151.224/28
    network 100.68.151.240/28
    
  neighbor 100.71.12.1
    description TO_Border1
    remote-as 64846
    no shutdown
    address-family ipv4 unicast
      activate
      prefix-list DefaultRoute in
      next-hop-self
    
  neighbor 100.71.12.9
    description TO_Border2
    remote-as 64846
    no shutdown
    address-family ipv4 unicast
      activate
      prefix-list DefaultRoute in
      next-hop-self
    
  neighbor 100.71.12.18
    description iBGP_PEER
    remote-as 64556
    no shutdown
    address-family ipv4 unicast
      activate
      next-hop-self
  
  template TO_TO_HNVPA
    ebgp-multihop 3
    listen 100.71.143.0/25 limit 5
    remote-as 65018
    update-source Loopback0



